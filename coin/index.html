<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>BizChange24</title>
    <link rel="stylesheet" type="text/css" href="style.css">
</head>
<body>
<header>
    <div class="menu">
        <span class="logo">BizChange24</span>
        <div class="navMenu">
            <a href="index.html" class="nav">Обмен</a>
            <a href="rez.html" class="nav">Резервы</a>
            <a href="kon.html" class="nav">Контакты</a>
        </div>
    </div>
</header>
<main>
    <div class="coin">
        <div class="coinObmen">
            <h1 class="give">Отдаете</h1>
            <h6 class="comment">Выберите валюту и сумму, которую хотите обменять</h6>
            <div class="select-wrapper">
                <div class="select-arrow-3"></div>
                <div class="select-arrow-3"></div>
                <label>
                    <select id="select">
                        <option value="Bitcoin">Bitcoin</option>
                        <option value="Bitcoin Cash">Bitcoin Cash</option>
                        <option value="Ethereum">Ethereum</option>
                        <option value="Ethereum Classic">Ethereum Classic</option>
                        <option value="Monero">Monero</option>
                        <option value="Ripple">Ripple</option>
                        <option value="Litecoin">Litecoin</option>
                        <option value="Dash">Dash</option>
                        <option value="Zcash">Zcash</option>
                        <option value="Dogecoin">Dogecoin</option>
                        <option value="Stellar">Stellar</option>
                    </select>
                </label>
            </div>
            <label>
                <input type="number" step="0.001" class="inp" placeholder="1" id="inputCripto"
                       oninput="input(this.value, 'inputCripto', 'select')" onchange="input(this.value, 'inputCripto', 'select')" >
            </label>
        </div>
        <div class="coinObmen">
            <h1 class="get">Получаете</h1>
            <h6 class="comment">Выберите валюту для получения</h6>
            <div class="select-wrapper">
                <div class="select-arrow-3"></div>
                <div class="select-arrow-3"></div>
                <label>
                    <select id="myselect">
                        <option value="Bitcoin">Bitcoin</option>
                        <option value="Bitcoin Cash">Bitcoin Cash</option>
                        <option value="Ethereum">Ethereum</option>
                        <option value="Ethereum Classic">Ethereum Classic</option>
                        <option value="Monero">Monero</option>
                        <option value="Ripple">Ripple</option>
                        <option value="Litecoin">Litecoin</option>
                        <option value="Dash">Dash</option>
                        <option value="Zcash">Zcash</option>
                        <option value="Dogecoin">Dogecoin</option>
                        <option value="Stellar">Stellar</option>
                    </select>
                </label>
            </div>
            <label>
                <input type="number" step="0.001" class="inp" placeholder="0.001" id="out"
                       oninput="input(this.value, 'out', 'myselect')" onchange="input(this.value, 'out', 'myselect')">
            </label>
        </div>
    </div>
    <h1 class="detal">Детали обмена</h1>
    <div style="display: flex; flex-direction: column; margin-left: 7%; margin-top: 3%">
        <div>
            <span class="form">Ваш E-mail ящик:</span>
            <label>
                <input type="email" class="inpEmail">
            </label>
        </div>
        <div>
            <span class="form">Кошелёк для получения:</span>
            <label>
                <input type="text" class="inpkey">
            </label>
        </div>
    </div>
    <button class="submit" type="submit">ОБМЕНЯТЬ</button>
</main>

<div style="display: flex; flex-direction: row; align-items: center; justify-content: center; display: none">
    <div class="criptoBlock">
        <h3>Отдаете</h3>
        <div>Bitcoin</div>
        <div>Bitcoin Cash</div>
        <div>Ethereum</div>
        <div>Ethereum Classic</div>
        <div>Ripple</div>
        <div>Litecoin</div>
        <div>Dash</div>
        <div>Zcash</div>
        <div>Dogecoin</div>
    </div>
    <div class="bitCripto">
        <h3>Получаете</h3>
        <div>Bitcoin</div>
        <div>Bitcoin Cash</div>
        <div>Ethereum</div>
        <div>Ethereum Classic</div>
        <div>Ripple</div>
        <div>Litecoin</div>
        <div>Dash</div>
        <div>Zcash</div>
        <div>Dogecoin</div>
    </div>
</div>

<script>
    const url = "http://3.14.15.74:3000/adminpanel/";
	fetch(url + 'getAllCurrencies', {
		method: 'POST'
    })
		.then(res => res.json())
		.then((response) => {
			data = response
		});
	let data;
	let rateFrom;
	let rateTo;
	const commision = 0.0025;

	function sel(id) {
        let selind = document.getElementById(id).options.selectedIndex;
		return document.getElementById(id).options[selind].value;
	}

	function input(num, va, id) {
		data.forEach(elem => {
			if (elem.currency === sel(id)) {
				rateFrom = elem.rate;
			}});

		document.getElementById(va).value = Number((((num - (num * commision)) / rateFrom) * rateTo).toFixed(6));
	}

</script>
</body>
</html>